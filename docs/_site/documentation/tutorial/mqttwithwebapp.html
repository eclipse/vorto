<!DOCTYPE html>
<html>
  <!--Head section for CSS/Javascript  -->

<head>
  <meta charset="utf-8">
  <meta content='width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no' name='viewport'>
  <meta name="description" content="IoT Toolset that lets you describe the characteristics of real world devices, share them in a central repository and generate code for different platforms">
  <meta name="author" content="">
  <!--base to have relative path for offline navigation -->





 
  <title>Eclipse Vorto - IoT Toolset for standardized device descriptions</title>

  <!--Stylesheets-->
  <!-- Bootstrap 3.3.1 -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.1/css/bootstrap.min.css" rel="stylesheet" type="text/css" />
  <!-- Font Awesome Icons -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.2.0/css/font-awesome.css" rel="stylesheet" type="text/css" />
  <link rel="stylesheet" href="../../css/prettyPhoto.css" type="text/css" media="screen" title="prettyPhoto main stylesheet" charset="utf-8" />
  <!-- Custom CSS -->
  <link href="../../css/vorto.css" rel="stylesheet">

  <!--Javascript-->
  <!-- JQuery 2.1.1-->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <!-- Bootstrap 3.3.1 JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.1/js/bootstrap.min.js" type="text/javascript"></script>
  <script src="../../js/jquery.prettyPhoto.js" type="text/javascript" charset="utf-8"></script>
  <script type="text/javascript" charset="utf-8">
               $(document).ready(function(){
                 $("a[rel^='prettyPhoto']").prettyPhoto();
               });
             </script>
</head>

  <body>
    <!--Header section Site navigation -->

<!--base to have relative path for offline navigation -->





 

<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
		<div class="container">
				<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-collapse">
								<span class="sr-only">Toggle navigation</span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
								<span class="icon-bar"></span>
						</button>
						<a class="navbar-brand" href="../../index.html">Eclipse Vorto</a>
				</div>
				<div class="collapse navbar-collapse wow fadeIn" id="navbar-collapse" data-wow-delay="0.2s">
						<ul class="nav navbar-nav pull-right">
							
								<li >
									
										<a href="../../news/index.html">News</a>

									
								</li>
							
								<li >
									
										<a href="../../blog/index.html">Blog</a>

									
								</li>
							
								<li >
									
										<a href="../../documentation/overview/introduction.html">Documentation</a>

									
								</li>
							
								<li >
									
										<a href="../../downloads/index.html">Downloads</a>

									
								</li>
							
								<li >
									
										<a target="_blank" href="http://vorto.eclipse.org/repo">Model Repository</a>
									
								</li>
							
								<li >
									
										<a href="../../overview/vorto_overview.html">Use cases</a>

									
								</li>
							
						</ul>
				</div>
				<!-- /.navbar-collapse -->
		</div>
		<style>#forkongithub a{background:#8d0c0c;color:#fff;text-decoration:none;font-family:Arial, Helvetica, sans-serif;text-align:center;font-weight:bold;padding:5px 40px;font-size:12px;line-height:3rem;position:relative;transition:0.5s;}#forkongithub a:hover{background:#c11;color:#fff;}#forkongithub a::before,#forkongithub a::after{content:"";width:100%;display:block;position:absolute;top:1px;left:0;height:1px;background:#fff;}#forkongithub a::after{bottom:1px;top:auto;}@media screen and (min-width:800px){#forkongithub{position:fixed;display:block;top:0;right:0;width:50px;overflow:visible;height:200px;z-index:9999;}#forkongithub a{width:260px;position:absolute;top:40px;right:-60px;transform:rotate(45deg);-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);-moz-transform:rotate(45deg);-o-transform:rotate(45deg);}}</style><span id="forkongithub"><a href="https://github.com/eclipse/vorto">Fork me on GitHub</a></span>
		<!-- /.container -->
</nav>

    <div id="header_wrapper" class="container">
      <div class="nav-bar col-md-3">
        <nav class="navmenu navmenu-default"  role="navigation">
          <ul class="nav navmenu-nav">
            <!--base to have relative path for offline navigation -->





 

  
    <li>
      Introduction
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/overview/introduction.html">Overview</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/overview/introduction.html#features">Features</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/overview/introduction.html#significant-contribution">Significant Contribution</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/overview/introduction.html#system-requirements">System Requirements</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Installation
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/installation/installation.html">Getting</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/installation/installation.html#installing-the-vorto-plug-ins">Installing</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/installation/installation.html#upgrading-the-vorto-plug-ins">Upgrading</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Model Editors
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/editors/datatype.html">Data Types</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/editors/functionblock.html#defining-a-function-block">Function Block</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/editors/information-model.html#defining-an-information-model">Information Model</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/editors/mapping-model.html#defining-an-information-model-mapping">Information Model Mapping</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Code Generators
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/code-generators/codegenerators.html">Overview</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/code-generators/webdevice-codegenerator.html#example-code-generator-web-device-application">Example - Web Device Application</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/code-generators/m2m-codegenerator.html#example-code-generator-bosch-m2m-platform">Example - Bosch M2M Platform</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Developer Api
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/developer-api/codegenerator-implementation.html">Implementing a Code Generator</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Vorto Repository
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/overview.html">Vorto Repository Overview</a>
      

    </li>
  

  
    <li>
      Web Interface
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/login-register.html">Registering/Logging in/out</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/search-web.html">Searching Models</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/generate-code-web.html">Generating Code</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/share-web.html">Sharing Models</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/generators.html">Informing about Generators</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/about_vorto.html">Visiting the Vorto Project Page</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/rest-api.html#rest-api">Using REST API</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/web-interface/user-settings.html">Managing User Settings</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Eclipse Vorto Integration
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/vorto-repository/eclipse-vorto-integration/setting-preferences-eclipse.html">Setting Required Preferences</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/eclipse-vorto-integration/search-eclipse.html">Searching Models</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/eclipse-vorto-integration/share-eclipse.html">Sharing Models</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/vorto-repository/eclipse-vorto-integration/generate-code-eclipse.html">Generating Code</a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Vorto CLI Tool
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/vorto-repository/cli-tool/cli-tool.html">Vorto CLI Tool</a>
      

    </li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  

  
    <li>
      Tutorial
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/tutorial/mqttwithwebapp.html">Establish communication between Web app and Mqtt client </a>
      

    </li>
  


      </ul>
    </li>
  

  
    <li>
      Appendix
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/appendix/troubleshooting.html">Troubleshooting</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/appendix/uninstallation.html">Uninstallation</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/appendix/migration-guide.html">Migration Guide</a>
      

    </li>
  

  
    <li>
      Model DSL Reference
      <ul class="nav navmenu-nav">
        <!-- 2nd level -->
        <!--base to have relative path for offline navigation -->





 

  
    <li  >
      
        <a href="../../documentation/appendix/datatype-dsl-reference.html">Data Type DSL</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/appendix/functionblock-dsl-reference.html">Function Block DSL</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/appendix/informationmodel-dsl-reference.html">Information Model DSL</a>
      

    </li>
  

  
    <li  >
      
        <a href="../../documentation/appendix/informationmodel-dsl-reference.html">Information Mapping Model DSL</a>
      

    </li>
  


      </ul>
    </li>
  


      </ul>
    </li>
  


          </ul>
      </nav>
    </div>


    <div id="page" class="col-md-9">
    	<div class="inner">
        <div id="maincontainer">
          <section id="top" class="documentation-section">
            <div class="row">
					     <div class="span8 offset3">
                 <!--base to have relative path for offline navigation -->

<h2 id="prerequisites">Prerequisites:</h2>

<ol>
  <li>
    <p>Install <a href="http://www.eclipse.org/downloads/packages/eclipse-ide-java-and-dsl-developers/mars2">Eclipse Mars DSL Tool</a></p>
  </li>
  <li>
    <p>Install Vorto - Download from <a href="../../downloads/index.html">here</a></p>
  </li>
  <li>
    <p>Java 8</p>
  </li>
  <li>
    <p>Set Network preferences in eclipse IDE</p>
  </li>
  <li>
    <p>Set maven settings</p>
  </li>
  <li>
    <p>Configure Information Model Repository in <a href="../../blog/2015-09-04-VortoIntegration.html">preferences</a></p>
  </li>
</ol>

<h2 id="overview">Overview</h2>

<p>In this tutorial, you are going to implement a web application for the information model through a series of steps.
The webapplication that is going to communicate with mqtt client will appear as shown below:
<img src="../../img/documentation/tut_tisensorwebui.jpg" alt="Web UIIntro" /></p>

<h3 id="lets-begin">Let’s begin!</h3>

<h2 id="step-1-implement-mqtt-client-for-functionblocks">Step 1: Implement MQTT client for functionblocks</h2>

<ol>
  <li>From eclipse, switch to Vorto perspective.</li>
  <li>Select Model Repository tab, Search for the info model <strong>TI_Sensor</strong></li>
  <li><em>TI_SensorTag</em> info model gets listed in the search result.</li>
  <li>Drag and drop this infomodel into the infomodel frame
 <img src="../../img/documentation/tut_searchdraginfomodel.jpg" alt="Search Infomodel" /></li>
  <li>Select the info model -&gt; Right-click  -&gt; Generate Code -&gt; <em>choose</em> MQTT Generator
 <img src="../../img/documentation/tut_generatemqtt.jpg" alt="Generate MQTT" /></li>
  <li>Switch back to java perspective. The generated project will not compile, since it requires some Java model classes for the device.</li>
  <li>Switch back to the Vorto Repository and Generate also the <em>Javabeans</em> for the TI SensorTag</li>
  <li>
    <p>Update mqtt and javabeans project. The MQTT Client project should fully compile now.</p>

    <p><img src="../../img/documentation/tut_tickmark.jpg" alt="mqttTick" /> Congratulations! You have just generated a MQTT client for the functionblocks, offered as functionality by the TI SensorTag.</p>
  </li>
</ol>

<h2 id="step-2--implement-a-web-application-for-the-information-model">Step 2:  Implement a Web Application for the information model</h2>

<p>In this exercise we are making our IoT app a little more sophisticated and display the MQTT sensor data in web UI Elements.</p>

<ol>
  <li>Switch to the Vorto Perspective and find the TI SensorTag information model.</li>
  <li>Right-click and choose <em>Web UI Generator</em> from the list of Generators</li>
  <li>Switch back to the Java Perspective. You should see another Eclipse Project added by the Web UI Generator (<em>webdevice.example</em>)</li>
  <li>
    <p>Convert this Project to an Eclipse Project as well. The Web application is a Spring Boot application and already fully runnable.Run the application.</p>

    <p><img src="../../img/documentation/tut_springbootrun.jpg" alt="SpringBoot app" /></p>
  </li>
  <li>Open your browser under [http://localhost:8080/webdevice]</li>
  <li>
    <p>In the web application, switch to the Accelerometer tab. You will see status fields that have been generated from the Accelerometer functionblock.</p>

    <p><img src="../../img/documentation/tut_tisensorwebui.jpg" alt="Web UI" /></p>

    <p><img src="../../img/documentation/tut_tickmark.jpg" alt="Tick" /> Congratulations! You just implemented a small AngularJS web application with the help of Vorto. However the Accelerometer UI fields are not yet populated with the sensor data. Let’s do that in the next exercise.</p>
  </li>
</ol>

<h2 id="step-3-sign-up-for-a-pubnub-account">Step 3: Sign up for a PubNub account</h2>

<ol>
  <li>You’ll need to <a href="https://www.pubnub.com/get-started/#">sign up for a PubNub account</a>.Once you sign up, you can get your unique PubNub keys in the <a href="https://admin.pubnub.com/#/user">PubNub Developer Portal</a>. You will use those same keys when you want to leverage our MQTT gateway.</li>
  <li>Take note of the Publish and Subscribe keys generated under Demo Keyset screen of PubNub.</li>
</ol>

<h2 id="step-4--receive-mqtt-status-events-and-bind-it-to-the-web-ui-elements">Step 4:  Receive MQTT status events and bind it to the Web UI Elements</h2>

<p>In this exercise we are going to glue the Web application together with the MQTT client, that Vorto had so nicely generated for us.</p>

<ol>
  <li>
    <p>In the pom.xml of the web application, add a dependency to the generated MQTT client
 <img src="../../img/documentation/tut_mqttdependency.jpg" alt="dependency" /></p>
  </li>
  <li>Go to the Spring Boot Application class and import the MQTT configuration for the Accelerometer (<em>@Import (MqttConfigurationAccelerometer.class</em>)).</li>
  <li>Find the commented code that handles the incoming MQTT events and un-comment it.</li>
  <li>Remove the annotation <em>@EnableScheduling</em>
 <img src="../../img/documentation/tut_springbootclass.jpg" alt="Springbootclass" /></li>
  <li>
    <p>Edit <strong>MqttConfigurationAccelerometer.java</strong> by adding the following lines to <strong>inboundAccelerometer</strong> method</p>

    <pre><code>MqttPahoMessageDrivenChannelAdapter adapter = new MqttPahoMessageDrivenChannelAdapter(this.connectionUrl, "pub-c-xxxx/sub-c-xxxx/clientAccelerometer_00c740db-9245-4e5a-8c80-8a50908ee69f");
adapter.addTopic(this.topicName);
</code></pre>
  </li>
  <li>
    <p>The MQTT configuration of the Accelerometer requires the MQTT topic and connection url in order to receive status events properly. Therefore we must add the following configuration to the <strong>application.yml</strong> file</p>

    <pre><code> 	server:
   	port: 8080
   	contextPath: /webdevice
 	publish_key  : "pub-c-xxxx"
 	subscribe_key : "sub-c-xxxx"
	mqtt:
   	connectionUrl: tcp://mqtt.pubnub.com
   	topic:
 	accelerometer: pub-c-xxxx/sub-c-xxxx/accelerometerTopic
</code></pre>
  </li>
  <li>Add MQTTlens extension to chrome browser.</li>
  <li>Create a new connection in MQTTlens by adding the following details in respective fields:
    <ul>
      <li>Connection name : pubnub</li>
      <li>Hostname : mqtt.pbnub.com</li>
      <li>Client ID: pub-c-xxxx/sub-c-xxxx/123</li>
    </ul>
  </li>
  <li>
    <p>Enter the following as <strong>Subscribe</strong> Topic</p>

    <pre><code> pub-c-xxxx/sub-c-xxxx/accelerometerTopic
</code></pre>
  </li>
  <li>
    <p>Enter the following as <strong>Publish</strong> Topic</p>

    <pre><code>pub-c-xxxx/sub-c-xxxx/accelerometerTopic
</code></pre>
  </li>
  <li>Click on <strong>Subscribe</strong>.</li>
  <li>
    <p>Enter the following message</p>

    <pre><code>{"currentAcceleration": {"speed":"44.4"}}
</code></pre>
  </li>
  <li>Click on <strong>Publish</strong></li>
  <li>Switch back to Web UI (http://localhost:8080/webdevice/#/accelerometer)</li>
  <li>The Speed field is updated with the value <strong>44.4</strong>
<img src="../../img/documentation/tut_pubnubtowebui.jpg" alt="Speedfield" /></li>
</ol>

                </div>
             </div>
          </section>
        </div>
      </div>
    </div>
  </div>
    <!-- Footer -->
<footer>
   <div class="container">
   <div class="row">
         <div class="col-md-4">
           <h3 class="footer-links-header">Quick Links</h3>
           <ul class="footer-links clearfix">
             <li><a href="http://www.eclipse.org/legal/privacy.php">Privacy Policy</a></li>
             <li><a href="http://www.eclipse.org/legal/termsofuse.php">Terms of Use</a></li>
             <li><a href="http://www.eclipse.org/legal/copyright.php">Copyright Agent</a></li>
             <li><a href="http://www.eclipse.org/legal/">Legal</a></li>
           </ul>
           <ul class="footer-links clearfix">
             <li><a href="http://www.eclipse.org">Eclipse Home</a></li>
             <li><a href="http://marketplace.eclipse.org/">Market Place</a></li>
             <li><a href="http://live.eclipse.org/">Eclipse Live</a></li>
             <li><a href="http://www.planeteclipse.org/">Eclipse Planet</a></li>
           </ul>
           </div>
         <div class="col-md-2">
          <h3 class="footer-links-header"><a href="http://eclipse.org/forums/eclipse.vorto" target="_blank" >Vorto Forum</a></h3>
         </div>
         <div class="col-md-6" data-twttr-id="twttr-sandbox-0">
           <h3 class="footer-links-header"><a href="https://twitter.com/VortoIoT">Vorto</a> on Twitter</h3>
           <a class="twitter-timeline"  href="https://twitter.com/VortoIoT" data-widget-id="624061088770994176" nofooter noborders noheader transparent height="250">Tweets by @VortoIoT</a>
           <script>
             !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");
            </script>
         </div>
       </div>
   </div>
</footer>

<!--/.Footer-->

  </body>

</html>
